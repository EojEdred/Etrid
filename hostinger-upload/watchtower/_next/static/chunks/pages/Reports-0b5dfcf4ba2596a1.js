(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49],{10405:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(48375).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},12298:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(48375).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},12363:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(14232);let a=()=>{let e=["old_state_broadcast","double_spend","invalid_signature","unauthorized_close"],t=["low","medium","high","critical"],r=e[Math.floor(Math.random()*e.length)],n=t[Math.floor(Math.random()*t.length)];return{id:"alert-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7)),channelId:"0x".concat(Math.random().toString(16).substring(2,42)),type:r,severity:n,timestamp:new Date(Date.now()-6048e5*Math.random()),description:s(r,n),evidenceHash:"0x".concat(Math.random().toString(16).substring(2,66)),resolved:Math.random()>.3,penaltyAmount:"critical"===n||"high"===n?Math.floor(5e3*Math.random())+1e3:void 0,reportedBy:Math.random()>.5?"0x".concat(Math.random().toString(16).substring(2,42)):void 0}},s=(e,t)=>({old_state_broadcast:"Detected attempt to broadcast old channel state. ".concat("critical"===t?"Immediate intervention required.":"Monitoring for further activity."),double_spend:"Suspicious double-spend attempt detected in channel transaction. ".concat("high"===t?"High risk of fraud.":"Under investigation."),invalid_signature:"Invalid signature detected in commitment transaction. ".concat("medium"===t?"Potential security breach.":"Verifying authenticity."),unauthorized_close:"Unauthorized channel closure attempt detected. ".concat("critical"===t?"Emergency intervention activated.":"Analyzing transaction.")})[e]||"Suspicious activity detected in channel.";function l(){let[e,t]=(0,n.useState)([]),[r,s]=(0,n.useState)({totalDetections:0,successfulInterventions:0,falsePositives:0,accuracy:0,pendingAlerts:0}),[l,i]=(0,n.useState)(!0),o=(0,n.useRef)(null),c=(0,n.useRef)(null),d=(0,n.useCallback)(()=>{let e=Array.from({length:12},()=>a());t(e),u(e)},[]),u=(0,n.useCallback)(e=>{let t=e.length,r=e.filter(e=>e.resolved&&e.penaltyAmount).length,n=Math.floor(.05*t);s({totalDetections:t,successfulInterventions:r,falsePositives:n,accuracy:t>0?(t-n)/t*100:0,pendingAlerts:e.filter(e=>!e.resolved).length})},[]),h=(0,n.useCallback)(async e=>{try{if(Math.random()>.95){let r=a();return r.channelId=e,t(e=>{let t=[r,...e];return u(t),t}),p(r),{fraudDetected:!0,alert:r}}return{fraudDetected:!1}}catch(e){return console.error("Fraud detection error:",e),{fraudDetected:!1,error:e}}},[u]),m=(0,n.useCallback)(async e=>{try{return console.log("Intervening in fraud alert: ".concat(e)),t(t=>t.map(t=>t.id===e?{...t,resolved:!0,penaltyAmount:t.penaltyAmount||1e3}:t)),{success:!0}}catch(e){return console.error("Intervention error:",e),{success:!1,error:e}}},[]),x=(0,n.useCallback)(async e=>{try{return console.log("Marking alert ".concat(e," as false positive")),t(t=>{let r=t.map(t=>t.id===e?{...t,resolved:!0,penaltyAmount:void 0}:t);return u(r),r}),{success:!0}}catch(e){return console.error("Failed to mark as false positive:",e),{success:!1,error:e}}},[u]),p=(0,n.useCallback)(e=>{var t,r,n;let a=JSON.parse(localStorage.getItem("watchtower-config")||"{}");(null===(t=a.notifications)||void 0===t?void 0:t.email)&&console.log("Sending email notification for alert:",e.id),(null===(r=a.notifications)||void 0===r?void 0:r.push)&&"Notification"in window&&"granted"===Notification.permission&&new Notification("Fraud Alert Detected",{body:e.description,icon:"/icon.png",tag:e.id}),(null===(n=a.notifications)||void 0===n?void 0:n.webhook)&&fetch(a.notifications.webhook,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch(e=>console.error("Webhook notification failed:",e))},[]),g=(0,n.useCallback)(()=>{i(!0),c.current=setInterval(()=>{if(Math.random()>.98){let e=a();t(t=>{let r=[e,...t];return u(r),r}),p(e)}},1e4)},[u,p]),y=(0,n.useCallback)(()=>{i(!1),c.current&&(clearInterval(c.current),c.current=null)},[]),b=(0,n.useCallback)(t=>e.filter(e=>e.severity===t),[e]),f=(0,n.useCallback)(()=>e.filter(e=>!e.resolved),[e]);return(0,n.useEffect)(()=>(d(),g(),"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission(),()=>{y(),o.current&&o.current.close()}),[d,g,y]),{alerts:e,fraudStats:r,isMonitoring:l,detectFraud:h,intervene:m,markAsFalsePositive:x,startMonitoring:g,stopMonitoring:y,getAlertsBySeverity:b,getUnresolvedAlerts:f}}},18609:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(48375).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},21040:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/Reports",function(){return r(28513)}])},28513:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var n=r(37876),a=r(14232),s=r(12363);let l=(0,r(48375).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var i=r(18609),o=r(10405),c=r(12298),d=r(46907);function u(){let{alerts:e,fraudStats:t}=(0,s.Z)(),[r,u]=(0,a.useState)(""),[h,m]=(0,a.useState)("all"),[x,p]=(0,a.useState)("all"),g=e.filter(e=>{let t=e.channelId.toLowerCase().includes(r.toLowerCase())||e.type.toLowerCase().includes(r.toLowerCase())||e.description.toLowerCase().includes(r.toLowerCase()),n="all"===h||e.severity===h,a="all"===x||"resolved"===x&&e.resolved||"pending"===x&&!e.resolved;return t&&n&&a});return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 text-white p-6",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsxs)("h1",{className:"text-4xl font-bold flex items-center gap-3",children:[(0,n.jsx)(l,{className:"w-10 h-10 text-blue-400"}),"Fraud Reports"]}),(0,n.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify(g.map(e=>({timestamp:e.timestamp.toISOString(),channelId:e.channelId,type:e.type,severity:e.severity,description:e.description,evidenceHash:e.evidenceHash,resolved:e.resolved,penaltyAmount:e.penaltyAmount})),null,2)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="fraud-report-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)},className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 rounded-lg transition-colors",children:[(0,n.jsx)(i.A,{className:"w-4 h-4"}),"Export Report"]})]}),(0,n.jsx)("p",{className:"text-gray-400",children:"Comprehensive fraud detection and intervention reports"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Total Detections"}),(0,n.jsx)("p",{className:"text-2xl font-bold mt-1",children:t.totalDetections})]}),(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Successful Interventions"}),(0,n.jsx)("p",{className:"text-2xl font-bold mt-1 text-green-400",children:t.successfulInterventions})]}),(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"False Positives"}),(0,n.jsx)("p",{className:"text-2xl font-bold mt-1 text-yellow-400",children:t.falsePositives})]}),(0,n.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20",children:[(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Accuracy Rate"}),(0,n.jsxs)("p",{className:"text-2xl font-bold mt-1 text-purple-400",children:[t.accuracy.toFixed(1),"%"]})]})]}),(0,n.jsx)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(o.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,n.jsx)("input",{type:"text",placeholder:"Search by channel, type, or description...",value:r,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/5 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,n.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"px-4 py-2 bg-white/5 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"all",children:"All Severities"}),(0,n.jsx)("option",{value:"low",children:"Low"}),(0,n.jsx)("option",{value:"medium",children:"Medium"}),(0,n.jsx)("option",{value:"high",children:"High"}),(0,n.jsx)("option",{value:"critical",children:"Critical"})]}),(0,n.jsxs)("select",{value:x,onChange:e=>p(e.target.value),className:"px-4 py-2 bg-white/5 border border-white/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"all",children:"All Status"}),(0,n.jsx)("option",{value:"pending",children:"Pending"}),(0,n.jsx)("option",{value:"resolved",children:"Resolved"})]})]})}),(0,n.jsx)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:(0,n.jsxs)("div",{className:"overflow-x-auto",children:[(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-white/5",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Timestamp"}),(0,n.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Channel ID"}),(0,n.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Type"}),(0,n.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Severity"}),(0,n.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Description"}),(0,n.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Penalty"}),(0,n.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold",children:"Status"})]})}),(0,n.jsx)("tbody",{className:"divide-y divide-white/10",children:g.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-white/5 transition-colors",children:[(0,n.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-300",children:[(0,n.jsx)("div",{children:new Date(e.timestamp).toLocaleDateString()}),(0,n.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,n.jsxs)("td",{className:"px-6 py-4 text-sm font-mono",children:[e.channelId.slice(0,12),"..."]}),(0,n.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,n.jsx)("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 rounded text-xs",children:e.type.replace(/_/g," ")})}),(0,n.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,n.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat((0,d.XY)(e.severity)),children:e.severity.toUpperCase()})}),(0,n.jsx)("td",{className:"px-6 py-4 text-sm text-gray-300 max-w-xs truncate",children:e.description}),(0,n.jsx)("td",{className:"px-6 py-4 text-sm font-semibold text-red-400",children:e.penaltyAmount?(0,d.vv)(e.penaltyAmount):"-"}),(0,n.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,n.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(e.resolved?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"),children:e.resolved?"Resolved":"Pending"})})]},e.id))})]}),0===g.length&&(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)(c.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-400",children:"No fraud reports found matching your criteria"})]})]})}),(0,n.jsxs)("div",{className:"mt-6 text-sm text-gray-400 text-center",children:["Showing ",g.length," of ",e.length," total reports"]})]})})}},46907:(e,t,r)=>{"use strict";function n(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function a(e){return new Intl.NumberFormat("en-US").format(e)}function s(e){return"".concat(e.toFixed(2),"%")}function l(e){return e<1e3?"".concat(e,"ms"):e<6e4?"".concat((e/1e3).toFixed(2),"s"):e<36e5?"".concat((e/6e4).toFixed(2),"m"):"".concat((e/36e5).toFixed(2),"h")}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return e.length<=2*t?e:"".concat(e.slice(0,t),"...").concat(e.slice(-t))}function o(e){return({active:"text-green-500",inactive:"text-gray-500",disputed:"text-yellow-500",closed:"text-red-500"})[e]||"text-gray-500"}function c(e){return({low:"text-blue-500 bg-blue-50 dark:bg-blue-950",medium:"text-yellow-500 bg-yellow-50 dark:bg-yellow-950",high:"text-orange-500 bg-orange-50 dark:bg-orange-950",critical:"text-red-500 bg-red-50 dark:bg-red-950"})[e]||"text-gray-500"}function d(e){let t=Math.floor((new Date().getTime()-e.getTime())/1e3);for(let[e,r]of Object.entries({year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1})){let n=Math.floor(t/r);if(n>=1)return"".concat(n," ").concat(e).concat(1!==n?"s":""," ago")}return"just now"}r.d(t,{Ee:()=>s,LV:()=>i,XY:()=>c,ZV:()=>a,a3:()=>l,fF:()=>d,qY:()=>o,vv:()=>n})},48375:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(14232);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...h}=e;return(0,n.createElement)("svg",{ref:t,...l,width:a,height:a,stroke:r,strokeWidth:o?24*Number(i)/Number(a):i,className:s("lucide",c),...h},[...u.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,n.forwardRef)((r,l)=>{let{className:o,...c}=r;return(0,n.createElement)(i,{ref:l,iconNode:t,className:s("lucide-".concat(a(e)),o),...c})});return r.displayName="".concat(e),r}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(21040)),_N_E=e.O()}]);