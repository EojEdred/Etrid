# V26 ASF SessionKeys - Quick Reference Card

## One-Line Commands

### For Individual Validators

```bash
# 1. Generate key
./scripts/v26-generate-asf-keys.sh

# 2. Register key
node scripts/v26-register-asf-keys.js --public-key $(cat ~/.etrid-asf-keys-backup/asf-public-key.txt) --validator-uri "YOUR_SEED_PHRASE"

# 3. Verify
node scripts/v26-verify-asf-keys.js --validator YOUR_ADDRESS

# 4. Restart node
systemctl restart flarechain-validator

# 5. Monitor
journalctl -u flarechain-validator -f | grep ASF
```

### For Network Operators

```bash
# Batch register all 20 validators
./scripts/v26-batch-register-validators.sh

# Verify all
node scripts/v26-verify-asf-keys.js --all --export-json deployment-$(date +%Y%m%d).json
```

## Script Locations

```
/Users/macbook/Desktop/etrid/scripts/
├── v26-generate-asf-keys.sh           # Generate ASF keypairs
├── v26-register-asf-keys.js           # Register keys on-chain
├── v26-batch-register-validators.sh   # Batch register all validators
└── v26-verify-asf-keys.js             # Verify registration

/Users/macbook/Desktop/etrid/docs/
└── V26_VALIDATOR_SETUP_GUIDE.md       # Complete documentation (25KB)
```

## Dependencies

```bash
# Install subkey
cargo install --force subkey --git https://github.com/paritytech/polkadot-sdk --locked

# Verify Node.js (v16+)
node --version

# @polkadot/api already installed
npm list @polkadot/api
```

## Common Options

| Script | Key Options |
|--------|------------|
| `v26-generate-asf-keys.sh` | `--keystore-path`, `--backup-dir`, `--help` |
| `v26-register-asf-keys.js` | `--public-key`, `--validator-uri`, `--rpc-endpoint`, `--dry-run` |
| `v26-verify-asf-keys.js` | `--validator`, `--all`, `--export-json`, `--rpc-endpoint` |
| `v26-batch-register-validators.sh` | No options (edit script for config) |

## Expected Files

```bash
# Generated by scripts
~/.etrid-asf-keys-backup/asf-key-TIMESTAMP.json          # Secret key backup
~/.etrid-asf-keys-backup/asf-public-key.txt              # Public key for registration
~/.local/share/.../keystore/asfkPUBLIC_KEY_HEX           # Keystore file
~/.etrid-v26-registration/registration-results-*.log     # Batch registration logs
```

## Troubleshooting One-Liners

```bash
# Check if subkey is installed
which subkey || echo "Install: cargo install --force subkey --git https://github.com/paritytech/polkadot-sdk --locked"

# Check if node is running
systemctl status flarechain-validator

# Check RPC is accessible
curl -H "Content-Type: application/json" -d '{"id":1, "jsonrpc":"2.0", "method": "system_chain"}' http://localhost:9944 2>/dev/null | grep result

# Check validator balance
# (Replace ADDRESS with your validator address)
node -e "const {ApiPromise,WsProvider}=require('@polkadot/api');(async()=>{const api=await ApiPromise.create({provider:new WsProvider('ws://localhost:9944')});const acc=await api.query.system.account('ADDRESS');console.log('Balance:',acc.data.free.toString());await api.disconnect();})();"

# Verify keystore file exists
ls -la ~/.local/share/flarechain/chains/flarechain_mainnet/keystore/asfk*

# Count ASF signatures in last hour
journalctl -u flarechain-validator --since "1 hour ago" | grep -c "ASF checkpoint signed"

# Check for ASF errors
journalctl -u flarechain-validator --since "1 day ago" | grep -i asf | grep -i error
```

## Security Checklist

- [ ] Never commit seed phrases to git
- [ ] Backup keys to encrypted offline storage (USB drives)
- [ ] Set proper file permissions (700 for dirs, 600 for files)
- [ ] Test with `--dry-run` before production
- [ ] Verify public key matches generated key
- [ ] Keep transaction hashes for audit
- [ ] Monitor logs after deployment
- [ ] Plan key rotation (6 months)

## Quick Deployment Workflow

```bash
# 1. Install dependencies (one-time)
cargo install --force subkey --git https://github.com/paritytech/polkadot-sdk --locked

# 2. Generate key
cd ~/Desktop/etrid && ./scripts/v26-generate-asf-keys.sh

# 3. Backup (CRITICAL - copy to USB drive)
cp ~/.etrid-asf-keys-backup/asf-key-*.json /path/to/secure/storage/

# 4. Test registration (dry-run)
node scripts/v26-register-asf-keys.js --public-key $(cat ~/.etrid-asf-keys-backup/asf-public-key.txt) --validator-uri "SEED" --dry-run

# 5. Register for real
node scripts/v26-register-asf-keys.js --public-key $(cat ~/.etrid-asf-keys-backup/asf-public-key.txt) --validator-uri "SEED"

# 6. Verify
node scripts/v26-verify-asf-keys.js --validator YOUR_ADDRESS

# 7. Restart
systemctl restart flarechain-validator

# 8. Monitor (Ctrl+C to exit)
journalctl -u flarechain-validator -f | grep ASF
```

## Help Commands

```bash
./scripts/v26-generate-asf-keys.sh --help
node scripts/v26-register-asf-keys.js --help
node scripts/v26-verify-asf-keys.js --help
```

## Documentation

- **Full Guide:** `/Users/macbook/Desktop/etrid/docs/V26_VALIDATOR_SETUP_GUIDE.md`
- **Summary:** `/Users/macbook/Desktop/etrid/V26_VALIDATOR_SCRIPTS_SUMMARY.md`
- **This Reference:** `/Users/macbook/Desktop/etrid/V26_QUICK_REFERENCE.md`

## Support

- GitHub: https://github.com/etrid/etrid/issues
- Discord: #validator-support
- Docs: See files above

---

**Print this for easy reference during deployment**
